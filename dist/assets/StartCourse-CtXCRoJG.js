import{r as o,j as e,b as L}from"./index-BkzoR9p6.js";import{a as w}from"./api-CI6MUtbO.js";import E from"./LoadingSpinner-Ts9d9r06.js";import"./index-t--hEgTQ.js";import"./constant-7LJQrAjc.js";const z=t=>{const[r,n]=o.useState(null),[a,m]=o.useState([]),[g,h]=o.useState(!0),[c,d]=o.useState(null),[p,u]=o.useState(!1),[x,i]=o.useState(!0),[f,y]=o.useState(0),[C,j]=o.useState(null),[S,N]=o.useState(null),Q=async(l,s)=>{if(C!==null)return;j(l);const b=l===s.correctAnswer;N(b);try{return await k(s._id,b),b}catch(I){throw j(null),N(null),I}},T=async()=>{j(null),N(null),f<a.length-1?y(f+1):(y(0),await v())},A=async()=>{var l;try{h(!0),d(null);try{await w.get(`progress/current/${t}`)}catch(s){if(((l=s.response)==null?void 0:l.status)===404)await w.post("progress/init",{courseId:t});else throw s}await v()}catch(s){d(s.message||"Failed to initialize course")}finally{h(!1)}},v=async()=>{var l;try{const{data:s}=await w.get(`progress/next-topic/${t}`);if(!(s!=null&&s.nextTopic)){u(!0);return}n(s.nextTopic),i(!0);const b=await w.get(`questions/topic/${s.nextTopic._id}`);m(((l=b.data)==null?void 0:l.questions)||[])}catch(s){throw d("Failed to load topic"),s}},k=async(l,s)=>{await w.post("progress/update",{courseId:t,topicId:r._id,level:r.difficulty,questionId:l,isCorrect:s,difficulty:r.difficulty})};return{topic:r,questions:a,loading:g,error:c,courseCompleted:p,showTopicIntro:x,initializeCourse:A,loadNextTopic:v,updateProgress:k,startQuestions:()=>{i(!1)},currentQuestionIndex:f,selectedOption:C,isCorrect:S,handleAnswer:Q,handleNextQuestion:T}},$=({topic:t,onStart:r})=>{const n={easy:"bg-green-100 text-green-800",medium:"bg-yellow-100 text-yellow-800",hard:"bg-red-100 text-red-800"};return e.jsxs("div",{className:"max-w-3xl mx-auto p-8 bg-white dark:bg-gray-800 rounded-xl shadow-lg",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 dark:text-gray-500 mb-2",children:t.name}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${n[t.difficulty]}`,children:t.difficulty})]}),e.jsx("div",{className:"prose max-w-none mb-8",children:e.jsx("p",{className:"text-gray-700 dark:text-gray-400 text-lg",children:t.description})}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:r,className:"px-6 py-3 bg-gradient-to-tl from-cyan-200 via-cyan-400 to-cyan-800 hover:scale-105 active:scale-95 hover:shadow-xl hover:pointer shadow-gray-800 dark:shadow-gray-300  font-medium rounded-lg transition-colors",children:"Start Questions"})})]})},q=({question:t,questionNumber:r,totalQuestions:n,selectedOption:a,isCorrect:m,onAnswer:g,onNext:h})=>{const[c,d]=o.useState(!1),p=async u=>{if(a===null){d(!0);try{await g(u,t)}finally{d(!1)}}};return t?e.jsxs("div",{className:"max-w-2xl mx-auto p-6 bg-white dark:bg-gray-800 rounded-xl shadow-lg",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("h3",{className:"text-xl font-semibold text-gray-700",children:["Question ",r,"/",n]})}),e.jsx("p",{className:"text-lg font-medium mb-6",children:t.questionText}),e.jsx("div",{className:"space-y-3 mb-8",children:t.options.map((u,x)=>{let i="w-full text-left p-4 rounded-lg border";return a!==null?x===t.correctAnswer?i+=" bg-green-100 border-green-300":x===a&&!m?i+=" bg-red-100 border-red-300":i+=" bg-gray-50 border-gray-200":i+=" bg-white border-gray-200 hover:bg-gray-50",e.jsx("button",{className:i,onClick:()=>p(x),disabled:a!==null||c,children:u},x)})}),a!==null&&e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:h,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",disabled:c,children:r===n?"Next Topic":"Next Question"})})]}):e.jsx("div",{className:"max-w-2xl mx-auto p-6 bg-white dark:bg-gray-800 rounded-xl shadow-lg",children:e.jsx("p",{className:"text-red-500",children:"Question data is not available"})})},P=()=>e.jsxs("div",{className:"max-w-3xl mx-auto p-8 text-center",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("svg",{className:"w-12 h-12 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Course Completed!"}),e.jsx("p",{className:"text-lg text-gray-600",children:"Congratulations on completing this course!"})]}),e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg mb-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-indigo-500 mb-3",children:"You did amazing!"}),e.jsx("p",{className:"text-indigo-700",children:"Your hard work and dedication have paid off. Keep up the great work!"})]}),e.jsx("button",{onClick:()=>window.location.href="/courses",className:"px-6 py-3 bg-indigo-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors",children:"Browse More Courses"})]}),R=({message:t,onRetry:r})=>e.jsxs("div",{className:"p-4 text-center text-red-600",children:[e.jsx("p",{children:t}),e.jsx("button",{onClick:r,className:"mt-4 bg-blue-500 text-white px-4 py-2 rounded",children:"Try Again"})]}),K=()=>{const{courseId:t}=L(),{topic:r,questions:n,loading:a,error:m,courseCompleted:g,showTopicIntro:h,currentQuestionIndex:c,selectedOption:d,isCorrect:p,initializeCourse:u,loadNextTopic:x,handleAnswer:i,handleNextQuestion:f,startQuestions:y}=z(t);return o.useEffect(()=>{t&&u()},[t]),a?e.jsx(E,{}):m?e.jsx(R,{message:m,onRetry:u}):g?e.jsx(P,{courseId:t}):h&&r?e.jsx($,{topic:r,onStart:y}):!n.length||!n[c]?e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("p",{children:"No questions available for this topic"}),e.jsx("button",{onClick:x,className:"mt-4 bg-blue-500 text-white px-4 py-2 rounded",children:"Load Next Topic"})]}):e.jsx(q,{question:n[c],questionNumber:c+1,totalQuestions:n.length,selectedOption:d,isCorrect:p,onAnswer:i,onNext:f})};export{K as StartCourse,K as default};
