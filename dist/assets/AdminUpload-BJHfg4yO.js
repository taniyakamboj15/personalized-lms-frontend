import{r as p,f as D,B as S,j as e,d as F,u as $,y as U}from"./index-Df9kuZqr.js";import{A as Q}from"./Alert-C-0HI56n.js";const O=s=>{const a=[];return s.title||a.push("Title is required"),s.description||a.push("Description is required"),s.imageUrl||a.push("Image URL is required"),a},R=s=>{const a=[];return s.courseId||a.push("Course selection is required"),s.title||a.push("Title is required"),s.content||a.push("Content is required"),a},H=s=>{const a=[];return s.topicId||a.push("Topic selection is required"),s.questionText||a.push("Question text is required"),s.options.some(r=>!r)&&a.push("All options must be filled"),a},L=()=>{const[s,a]=p.useState("course"),[r,o]=p.useState([]),[f,d]=p.useState([]),[u,i]=p.useState(null),[m,x]=p.useState(!1);p.useEffect(()=>{if(!u)return;const n=setTimeout(()=>{i(null)},3e3);return()=>clearTimeout(n)},[u]);const[c,v]=p.useState({title:"",description:"",imageUrl:"",difficulty:"easy"}),[l,b]=p.useState({courseId:"",title:"",content:"",difficulty:"easy"}),[T,y]=p.useState({topicId:"",questionText:"",options:["","","",""],correctAnswer:0,difficulty:"easy"}),C=async()=>{try{const[n,q]=await Promise.all([D.get(`${S}course`),D.get(`${S}topic`)]);o(n.data),d(q.data)}catch{i({msg:"Error fetching data",type:"error"})}};p.useEffect(()=>{C()},[]);const t=()=>{let n=[];return s==="course"?n=O(c):s==="topic"?n=R(l):n=H(T),n},g=async n=>{var I,E;n.preventDefault(),x(!0);const q=t();if(q.length>0){i({msg:q.join(", "),type:"error"}),x(!1);return}try{let h,N;s==="course"?(h=c,N="admin/add-course"):s==="topic"?(h=l,N="admin/add-topic"):(h=T,N="admin/add-question"),await D.post(`${S}${N}`,h,{withCredentials:!0}),i({msg:"Added successfully!",type:"success"}),w(),s!=="question"&&C()}catch(h){i({msg:((E=(I=h==null?void 0:h.response)==null?void 0:I.data)==null?void 0:E.message)||"Error adding",type:"error"})}finally{x(!1)}},w=()=>{s==="course"?v({title:"",description:"",difficulty:"easy",imageUrl:""}):s==="topic"?b({courseId:"",title:"",content:"",difficulty:"easy"}):y({topicId:"",questionText:"",options:["","","",""],correctAnswer:0,difficulty:"easy"})};return{activeTab:s,setActiveTab:a,courses:r,topics:f,alert:u,setAlert:i,courseData:c,setCourseData:v,topicData:l,setTopicData:b,questionData:T,setQuestionData:y,handleSubmit:g,isSubmitting:m}},M=({activeTab:s,setActiveTab:a})=>e.jsx("div",{className:"flex justify-center gap-4 mb-8",children:["course","topic","question"].map(r=>e.jsxs("button",{onClick:()=>a(r),className:`flex items-center gap-2 px-5 py-2 rounded-full font-medium text-sm transition-all duration-300 
            ${s===r?"bg-gradient-to-r from-orange-400 to-orange-700 text-white  shadow-md scale-105":"bg-gray-100 dark:bg-gray-800 hover:dark:bg-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-200 dark:border-gray-100 dark:border"}`,children:[r==="course"&&e.jsx("i",{className:"fas fa-book"}),r==="topic"&&e.jsx("i",{className:"fas fa-tags"}),r==="question"&&e.jsx("i",{className:"fas fa-question-circle"}),r==="course"?"Add Course":r==="topic"?"Add Topic":"Add Question"]},r))}),A=({label:s,type:a="text",value:r,onChange:o,placeholder:f,className:d="",required:u=!1,disabled:i=!1})=>e.jsxs("div",{className:"mb-4",children:[s&&e.jsxs("label",{className:"block mb-1 font-medium text-gray-700 dark:text-gray-200",children:[s," ",u&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:a,className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200 ${d}`,placeholder:f,value:r,onChange:o,required:u,disabled:i})]}),k=({label:s,value:a,onChange:r,placeholder:o,className:f="",required:d=!1,rows:u=4})=>e.jsxs("div",{className:"mb-4",children:[s&&e.jsxs("label",{className:"block mb-1 font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800",children:[s," ",d&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200 ${f}`,placeholder:o,value:a,onChange:r,required:d,rows:u})]}),j=({label:s,value:a,onChange:r,options:o=[],className:f="",required:d=!1,disabled:u=!1})=>e.jsxs("div",{className:"mb-4",children:[s&&e.jsxs("label",{className:"block mb-1 font-medium text-gray-700 dark:text-gray-300",children:[s," ",d&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200 ${f}`,value:a,onChange:r,required:d,disabled:u,children:o.map(i=>e.jsx("option",{value:i.value,disabled:i.disabled,children:i.label},i.value))})]}),P=()=>{const{role:s}=F(t=>{var g;return((g=t==null?void 0:t.user)==null?void 0:g.user)||{}}),a=$(),r=s==="admin",{activeTab:o,setActiveTab:f,courses:d,topics:u,alert:i,courseData:m,setCourseData:x,topicData:c,setTopicData:v,questionData:l,setQuestionData:b,handleSubmit:T,isSubmitting:y}=L();p.useEffect(()=>{r||(U.error("You are not authorized to access this page."),a("/"))},[r,a]);const C=()=>e.jsxs("form",{onSubmit:T,className:"bg-white dark:bg-gray-800 dark:border-gray-500 border-2 p-6 rounded-2xl shadow-xl space-y-4",children:[o==="course"&&e.jsxs(e.Fragment,{children:[e.jsx(A,{label:"Course Title",value:m.title,onChange:t=>x({...m,title:t.target.value}),placeholder:"Title",required:!0}),e.jsx(k,{label:"Description",value:m.description,onChange:t=>x({...m,description:t.target.value}),placeholder:"Description",required:!0}),e.jsx(A,{label:"Image URL",type:"url",value:m.imageUrl,onChange:t=>x({...m,imageUrl:t.target.value}),placeholder:"https://example.com/image.jpg",required:!0}),e.jsx(j,{label:"Difficulty",value:m.difficulty,onChange:t=>x({...m,difficulty:t.target.value}),options:[{value:"easy",label:"Easy"},{value:"medium",label:"Medium"},{value:"hard",label:"Hard"}]})]}),o==="topic"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Course",value:c.courseId,onChange:t=>v({...c,courseId:t.target.value}),options:[{value:"",label:"-- Select Course --",disabled:!0},...d.map(t=>({value:t._id,label:t.title}))],required:!0}),e.jsx(A,{label:"Topic Title",value:c.title,onChange:t=>v({...c,title:t.target.value}),placeholder:"Title",required:!0}),e.jsx(k,{label:"Content",value:c.content,onChange:t=>v({...c,content:t.target.value}),placeholder:"Content",required:!0}),e.jsx(j,{label:"Difficulty",value:c.difficulty,onChange:t=>v({...c,difficulty:t.target.value}),options:[{value:"easy",label:"Easy"},{value:"medium",label:"Medium"},{value:"hard",label:"Hard"}]})]}),o==="question"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Topic",value:l.topicId,onChange:t=>b({...l,topicId:t.target.value}),options:[{value:"",label:"-- Select Topic --",disabled:!0},...u.map(t=>({value:t._id,label:t.title}))],required:!0}),e.jsx(k,{label:"Question",value:l.questionText,onChange:t=>b({...l,questionText:t.target.value}),placeholder:"Question Text",required:!0}),l.options.map((t,g)=>e.jsx(A,{label:`Option ${g+1}`,value:t,onChange:w=>{const n=[...l.options];n[g]=w.target.value,b({...l,options:n})},placeholder:`Option ${g+1}`,required:!0},g)),e.jsx(j,{label:"Correct Answer",value:l.correctAnswer,onChange:t=>b({...l,correctAnswer:Number(t.target.value)}),options:[{value:0,label:"Option 1"},{value:1,label:"Option 2"},{value:2,label:"Option 3"},{value:3,label:"Option 4"}]}),e.jsx(j,{label:"Difficulty",value:l.difficulty,onChange:t=>b({...l,difficulty:t.target.value}),options:[{value:"easy",label:"Easy"},{value:"medium",label:"Medium"},{value:"hard",label:"Hard"}]})]}),e.jsx("button",{type:"submit",disabled:y,className:`w-full bg-orange-400 hover:bg-orange-700 text-white py-2 rounded-lg font-semibold transition duration-200 ${y?"opacity-50 cursor-not-allowed":""}`,children:y?e.jsx("span",{className:"loading loading-spinner loading-md"}):"Submit"})]});return e.jsxs("div",{className:"p-6 max-w-3xl mx-auto",children:[e.jsxs("h2",{className:"text-3xl font-bold text-center mb-8 text-balck drop-shadow",children:["Admin Panel -"," ",o==="course"?"Add Course":o==="topic"?"Add Topic":"Add Question"]}),e.jsx(M,{activeTab:o,setActiveTab:f}),i&&e.jsx("div",{className:"mb-4",children:e.jsx(Q,{message:i.msg,type:i.type})}),e.jsx("div",{className:"transition-all duration-500",children:C()})]})};export{P as default};
